!function(e){function t(t){for(var i,l,o=t[0],s=t[1],c=t[2],d=0,f=[];d<o.length;d++)l=o[d],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&f.push(r[l][0]),r[l]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);for(u&&u(t);f.length;)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,o=1;o<n.length;o++){var s=n[o];0!==r[s]&&(i=!1)}i&&(a.splice(t--,1),e=l(l.s=n[0]))}return e}var i={},r={0:0},a=[];function l(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=i,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)l.d(n,i,function(t){return e[t]}.bind(null,i));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/gol-mp/";var o=window.webpackJsonp=window.webpackJsonp||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=s;a.push([22,1]),n()}({22:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),r=i.lightningChart().ChartXY({}).setTitle("Conway's Game of Life").setAutoCursorMode(i.AutoCursorModes.disabled).setChartBackgroundFillStyle(new i.SolidFill({color:i.ColorHEX("#fff")})),a=r.getDefaultAxisX(),l=r.getDefaultAxisY(),o=r.addAxisX(!0),s=r.addAxisY(!0),c=function(e){e.setTickStyle(i.emptyTick).setScrollStrategy(void 0)};c(a),c(l),c(o),c(s);var u=new(function(){function e(e,t){this.chart=e,this.px=t,this.outOfBoundsSeries=this.chart.addRectangleSeries().setDefaultStyle(function(e){return e.setFillStyle(new i.SolidFill({color:i.ColorRGBA(255,200,200)}))}),this.outOfBoundsRight=this.outOfBoundsSeries.add({x1:0,y1:0,x2:0,y2:0}),this.outOfBoundsTop=this.outOfBoundsSeries.add({x1:0,y1:0,x2:0,y2:0}),this.points=this.chart.addPointSeries({pointShape:i.PointShape.Square}).setPointSize(this.px).setMouseInteractions(!1).setPointFillStyle(new i.SolidFill({color:i.ColorRGBA(100,100,100)})),this.deadPoints=this.chart.addPointSeries({pointShape:i.PointShape.Square}).setPointSize(this.px).setMouseInteractions(!1).setPointFillStyle(new i.SolidFill({color:i.ColorRGBA(200,255,200)})),this.cellStates=[[]],this.cellStatesFlipBuffer=[[]]}return e.prototype.cycle=function(){for(var e=this.getState(),t=e.cellStates,n=e.bounds,i=t.length,r=0;r<i;r++)for(var a=t[r].length,l=0;l<a;l++){var o=t[r][l],s=0;r>n.x.min&&(l>n.y.min&&(s+=t[r-1][l-1]?1:0),l<n.y.max&&(s+=t[r-1][l+1]?1:0),s+=t[r-1][l]?1:0),l>n.y.min&&(s+=t[r][l-1]?1:0),l<n.y.max&&(s+=t[r][l+1]?1:0),r<n.x.max&&(l>n.y.min&&(s+=t[r+1][l-1]?1:0),l<n.y.max&&(s+=t[r+1][l+1]?1:0),s+=t[r+1][l]?1:0);var c=void 0===o&&void 0;(o&&(2===s||3===s)||!o&&3===s)&&(c=!0),this.cellStatesFlipBuffer[r][l]=c}this.cellStates=this.cellStatesFlipBuffer,this.cellStatesFlipBuffer=t},e.prototype.plot=function(){var e=this.points,t=this.deadPoints;e.clear(),t.clear();for(var n=this.px,i=this.px/2,r=this.cellStates,a=r.length,l=0;l<a;l++)for(var o=r[l].length,s=0;s<o;s++){var c=r[l][s];!0===c?e.add({x:i+l*n,y:i+s*n}):!1===c&&t.add({x:i+l*n,y:i+s*n})}},e.prototype.handleResize=function(e,t){var n=this.cellStates.length,i=this.cellStates[0].length,r=Math.floor(e/this.px),a=Math.floor(t/this.px),l=a>i;if(r>n)for(var o=n;o<r;o++)this.cellStates.push([]),this.cellStatesFlipBuffer.push([]);else this.cellStates.length=r,this.cellStatesFlipBuffer.length=r;for(var s=0;s<r;s++)if(l)for(o=i;o<a;o++)this.cellStates[s][o]=void 0,this.cellStatesFlipBuffer[s][o]=void 0;else this.cellStates[s].length=a,this.cellStatesFlipBuffer[s].length=a},e.prototype.getState=function(){return{cellStates:this.cellStates,bounds:{x:{min:0,max:this.cellStates.length-1,center:Math.round((this.cellStates.length-1)/2)},y:{min:0,max:this.cellStates[0].length-1,center:Math.round((this.cellStates[0].length-1)/2)}}}},e.prototype.clear=function(e){for(var t=e.length,n=0;n<t;n++)for(var i=e[n].length,r=0;r<i;r++)e[n][r]=void 0},e.prototype.initialState=function(){var e=this.getState();e.cellStates,e.bounds},e.prototype.encodeState=function(){return this.cellStates.map(function(e){return e.map(function(e){return String(e)})})},e.prototype.decodeState=function(e){var t=e.map(function(e){return e.map(function(e){return"undefined"===e?void 0:"false"!==e})});this.cellStates=t;var n=this.cellStates.length,i=this.cellStates[0].length;this.handleResize(n*this.px,i*this.px);var r={x1:n*this.px,y1:0,x2:a.scale.getInnerEnd(),y2:l.scale.getInnerEnd()};this.outOfBoundsRight.setDimensions(r);var o={x1:0,y1:(i+1)*this.px,x2:n*this.px,y2:l.scale.getInnerEnd()};this.outOfBoundsTop.setDimensions(o)},e}())(r,8),d=function(){u.plot(),console.log("currently rendered cycle: ",g)},f=r.addRectangleSeries().add({x1:0,y1:0,x2:0,y2:0}).setFillStyle(i.transparentFill).setFillStyleHighlight(i.transparentFill),h=function(){if(C)throw new Error("Resizing is not allowed in multiplayer mode !");var e=a.scale.getCellSize(),t=l.scale.getCellSize();a.setInterval(0,e),l.setInterval(0,t),u.handleResize(e,t),f.setDimensions({x1:0,y1:0,x2:e,y2:t}),d()};r.onResize(h),h(),u.initialState(),u.plot();var p=!1,g=0,y=function(){U&&U(),u.cycle(),d(),p&&setTimeout(y,1e3)},v=r.addUIElement(i.UILayoutBuilders.Column).setPosition({x:0,y:100}).setOrigin(i.UIOrigins.LeftTop).setPadding({top:2,left:4}).setDraggingMode(i.UIDraggingModes.notDraggable),S=v.addElement(i.UIElementBuilders.CheckBox).setText("Simulation enabled").setFont(function(e){return e.setSize(14)});S.onSwitch(function(e,t){(p=t)&&y()}),p&&S.setOn(!0);var x=v.addElement(i.UIElementBuilders.ButtonBox).setText("Clear").setFont(function(e){return e.setSize(14)});x.onSwitch(function(e,t){if(t&&(u.clear(u.cellStates),d(),C&&C)){var n=C.ref().child("session-interactions").push().key,i={type:"clear",uuid:D()},r={};r["/session-interactions/"+n]=i,C.ref().update(r)}});for(var b,m=r.addUIElement(i.UILayoutBuilders.Row.setBackground(i.UIBackgrounds.Rectangle)).setPosition({x:0,y:0}).setOrigin(i.UIOrigins.LeftBottom).setMargin({bottom:2,left:4}).setPadding({left:4,right:4}).setDraggingMode(i.UIDraggingModes.draggable).setBackground(function(e){return e.setFillStyle(i.DefaultLibraryStyle.panelBackgroundFillStyle.setA(100))}),B=[{label:"Pencil",draggable:!0,patterns:[{label:"1 px",pattern:[[!0]]},{label:"2 px",pattern:[[!0,!0],[!0,!0]]},{label:"3 px",pattern:[[!0,!0,!0],[!0,!0,!0],[!0,!0,!0]]},{label:"5 px",pattern:[[!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0]]}]},{label:"Glider",draggable:!1,patterns:[{label:"↘",pattern:[[!1,!0,!1],[!1,!1,!0],[!0,!0,!0]]},{label:"↗",pattern:[[!0,!0,!0],[!1,!1,!0],[!1,!0,!1]]},{label:"↙",pattern:[[!1,!0,!1],[!0,!1,!1],[!0,!0,!0]]},{label:"↖",pattern:[[!0,!0,!0],[!0,!1,!1],[!1,!0,!1]]}]},{label:"Spaceship",draggable:!1,patterns:[{label:"→",pattern:[[!1,!0,!0,!0,!0],[!0,!1,!1,!1,!0],[!1,!1,!1,!1,!0],[!0,!1,!1,!0,!1]]},{label:"⬅",pattern:[[!0,!0,!0,!0,!1],[!0,!1,!1,!1,!0],[!0,!1,!1,!1,!1],[!1,!0,!1,!1,!0]]}]},{label:"Methuselahs",draggable:!1,patterns:[{label:"The R-pentomino",pattern:[[!1,!0,!0],[!0,!0,!1],[!1,!0,!1]]},{label:"Diehard",pattern:[[!1,!1,!1,!1,!1,!1,!0,!1],[!0,!0,!1,!1,!1,!1,!1,!1],[!1,!0,!1,!1,!1,!0,!0,!0]]},{label:"Acorn",pattern:[[!1,!0,!1,!1,!1,!1,!1],[!1,!1,!1,!0,!1,!1,!1],[!0,!0,!1,!1,!0,!0,!0]]}]},{label:"Eater",draggable:!1,patterns:[{label:"↖",pattern:[[!0,!0,!1,!1],[!0,!1,!0,!1],[!1,!1,!0,!1],[!1,!1,!0,!0]]}]},{label:"Generators",draggable:!1,patterns:[{label:"Gosper glider gun ↘",pattern:[[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!0,!1,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0],[!0,!0,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!0,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!0,!0,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!0,!1,!0,!0,!1,!1,!1,!1,!0,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]]}]}],M=[],I=B[0].patterns,T=function(e){var t=e.draggable?i.UIButtonPictures.Circle:i.UIButtonPictures.Rectangle,n=function(n,r,a){var l=n.addElement(i.UIElementBuilders.CheckBox.setPictureOn(t).setPictureOff(t)).setText(r).setFont(function(e){return e.setSize(14)});0===M.length&&(l.setOn(!0),I=a,b=e.draggable),l.onSwitch(function(t,n){return function(e,t,n,i){if(t){I=n,b=i.draggable;for(var r=0,a=M;r<a.length;r++){var l=a[r];l!==e&&l.setOn(!1)}}}(t,n,a,e)}),M.push(l)},r=m.addElement(i.UILayoutBuilders.Column);if("pattern"in e.patterns[0]){var a=e.patterns;r.addElement(i.UIElementBuilders.TextBox).setText(e.label).setFont(function(e){return e.setSize(14)});for(var l=0,o=a;l<o.length;l++){var s=o[l];n(r,s.label,s.pattern)}}else n(r,e.label,e.patterns);r.addGap()},E=0,O=B;E<O.length;E++){T(O[E])}var w=function(e,t){var n=i.translatePoint(r.engine.clientLocation2Engine(e,t),r.engine.scale,{x:a.scale,y:l.scale}),o=Math.round(n.x/u.px),s=Math.round(n.y/u.px),c=u.getState().bounds;if(!(o<c.x.min||o>c.x.max||s<c.y.min||s>c.y.max))return u.cellStates[o][s]},P=function(e,t,n){var o=i.translatePoint(r.engine.clientLocation2Engine(e,t),r.engine.scale,{x:a.scale,y:l.scale}),s=o.x/u.px,c=o.y/u.px,f=I,h=f.length,p=f.reduce(function(e,t){return Math.max(e,t.length)},0),y=u.getState().bounds;if(!(Math.round(s-.5*p)<y.x.min||Math.round(s+.5*p)>y.x.max||Math.round(c-.5*h)<y.y.min||Math.round(c+.5*h)>y.y.max)){var v={type:"draw",uuid:D(),cycle:g,locationCol:s,locationRow:c,pattern:f,state:String(n)};if(L(v),C){var S={};S["/session-interactions/"+C.ref().child("session-interactions").push().key]=v,C.ref().update(S)}d()}},F=void 0;f.onMouseDown(function(e,t){return P(t.clientX,t.clientY)}),f.onMouseDragStart(function(e,t){F=!w(t.clientX,t.clientY)}),f.onMouseDrag(function(e,t){return b?P(t.clientX,t.clientY,F):void 0}),f.onTouchStart(function(e,t){for(var n=0;n<t.changedTouches.length;n++)F=!w(t.changedTouches[n].clientX,t.changedTouches[n].clientY),P(t.changedTouches[n].clientX,t.changedTouches[n].clientY)}),f.onTouchMove(function(e,t){for(var n=0;n<t.changedTouches.length;n++)b&&P(t.changedTouches[n].clientX,t.changedTouches[n].clientY,F)});var U,C,R,k=r.addUIElement(i.UILayoutBuilders.Column).setPosition({x:100,y:100}).setOrigin(i.UIOrigins.RightTop),D=function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)},z=[],A=[],X=function(){C.ref("session-interactions").on("value",function(e){var t=e.val();if(null!==t){var n=[],i=z.length;for(var r in t){for(var a=t[r],l=!1,o=0;o<i;o++){if(z[o].uuid===a.uuid){l=!0;break}}l||n.push(a)}j(n)}})},j=function(e){if(0!==e.length){var t=e.sort(function(e,t){return e.cycle-t.cycle});if(t[0].cycle<g){if(!R)throw new Error("Back-tracking necessary, but previous states are not saved !");var n=z.concat(t);n=n.sort(function(e,t){return e.cycle-t.cycle});var i=t[0].cycle;!function(e){var t=R.find(function(t){return t.cycle===e});if(void 0===t)throw new Error("Back-tracking necessary, but there is no saved state for cycle:"+e);u.decodeState(t.state)}(i);for(var r=i;r<g;r++){for(var a=0,l=n;a<l.length;a++){(h=l[a]).cycle===r&&L(h)}u.cycle()}for(var o=0,s=n;o<s.length;o++){(h=s[o]).cycle===g&&L(h)}}else for(var c=0,f=e;c<f.length;c++){var h=f[c];L(h)}d()}},L=function(e){var t=e.uuid,n=e.type;if("draw"===n){var i=e.pattern,r=e.locationCol,a=e.locationRow,l=e.state;l="undefined"===l?void 0:"true"===l;for(var o=i.length,s=i.reduce(function(e,t){return Math.max(e,t.length)},0),c=0;c<i.length;c++)for(var f=0;f<i[c].length;f++)if(!0===i[c][f]){var h=Math.round(r+f-s/2),p=Math.round(a-c+o/2);u.cellStates[h][p]=void 0===l?!0!==u.cellStates[h][p]:l}}else"clear"===n&&(u.clear(u.cellStates),d());void 0===z.find(function(e){return e.uuid===t})&&z.push(e)};k.addElement(i.UIElementBuilders.ButtonBox).setText("Host").onSwitch(function(e,t){t&&function(){C=firebase.database(),g=-1;var e=u.encodeState();C.ref("session-initialState").set(e),C.ref("session-simulationEnabled").set(p),C.ref("session-cycle").set(g),C.ref("session-interactions").set([]),R=[],(U=function(){R.length>=8&&R.shift(),R.push({cycle:g,state:u.encodeState()}),g++,C.ref("session-cycle").set(g)})(),X(),k.dispose(),r.addUIElement(i.UIElementBuilders.TextBox).setPosition({x:100,y:100}).setOrigin(i.UIOrigins.RightTop).setText("Hosting session")}()}),k.addElement(i.UIElementBuilders.ButtonBox).setText("Connect").onSwitch(function(e,t){t&&function(){C=firebase.database(),p=!1,S.dispose(),C.ref("session-initialState").once("value",function(e){var t=e.val();u.decodeState(t),d()});var e=!0;C.ref("session-cycle").on("value",function(t){var n=t.val();if(e)g=n,e=!1;else for(g=g;g<n;g++){for(var i=0,r=A;i<r.length;i++){var a=r[i];g===a.cycle&&L(a)}u.cycle()}d()}),X(),k.dispose(),k.dispose(),r.addUIElement(i.UIElementBuilders.TextBox).setPosition({x:100,y:100}).setOrigin(i.UIOrigins.RightTop).setText("Connected to remote session"),x.dispose()}()})}});